# FudanLMS
[TOC]

## 使用说明

### 需要额外安装的包

```go
"github.com/go-sql-driver/mysql"
"github.com/howeyc/gopass"
```

运行main.exe。

### 命令列表

该列表也可在终端输入help得到。

| 参数             | 含义                   |
| ---------------- | ---------------------- |
| help             | 显示帮助文本           |
| exit             | 退出终端               |
| quit             | 退出终端               |
| lg               | 登陆账号               |
| fdbk -[ait] info | 查找书籍               |
| chpsw            | 修改密码               |
| rg               | 注册新账号             |
| ad               | 添加新书               |
| rm               | 删除书籍               |
| borbk            | 借阅书籍               |
| fdrec -[bar]     | 查询借阅/归还记录      |
| ckddl            | 查询还书期限           |
| ckdue            | 查询是否有超期未还书籍 |
| ext              | 延长还书期限           |
| ret              | 还书                   |
| res              | 重置账户密码           |

## 文件说明

- main.go：后端操作数据库的所有函数。
- models.go：该系统中定义的所有结构体、大部分常量字符串。
- shell.go：前端与用户交互的所有函数。
- create_table.sql：预先读入的示例数据的建表部分（实际运行时并未使用该文件，而是写入models.go中）
- insert_data.sql：预先读入的示例数据的插入数据部分（实际运行时并未使用该文件，而是写入models.go中）
- main_test.go：对main.go中大部分函数的测试函数。
- test.out：测试之后生成的结果。
- main.exe：编译生成的可执行文件。

## 测试说明

**注意**：由于系统与用户在连接数据库时存在交互过程，因此master分支中无法直接通过`go test`测试代码，只保留了测试后生成的结果。可以在test分支中通过`go test`测试代码，添加更多测试用例。

### 测试结果

测试总覆盖率为43.8%。其中main.go覆盖率81.7%，models.go覆盖率41.7%，shell.go覆盖率0%（因为shell.go中均为与用户直接交互的函数）

具体覆盖情况可在命令行中键入`go tool cover -html=test.out`查看。

## 身份与对应权限

在FudanLMS中共有4种身份，每种身份拥有不同的操作权限。

### 通用权限

所有身份的用户均可：

- 使用FudanLMS通过书名、作者、ISBN查找相关书籍。

- 通过用户名和对应密码进行登录。

### 暂停借阅的学生权限

被暂停借阅的学生还可以：

- 修改密码。
- 查询**自己**的借阅记录、还书期限。
- 查询**自己**是否有超期未还的书籍。
- 归还**自己**借阅的书籍。

### 正常借阅的学生权限

正常借阅的学生还可以：

- 借阅书籍。
- 延长**自己**的还书期限。（增加延长次数）

### 管理员权限

管理员用户还可以：

- 注册新的管理员账号或学生账号。
- 添加或删除数据库中的书籍。

- 重置**任何用户**的密码。
- 查询**任何用户**的借阅记录、还书期限。
- 查询**任何用户**是否有超期未还的书籍。
- 延长**任何用户**的还书期限（不增加延长次数）
- 归还**任何用户**借阅的书籍。

